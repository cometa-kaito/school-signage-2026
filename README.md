# School Signage (Edix by Rebounder)

å­¦æ ¡ãƒ»æ•™å®¤å‘ã‘ãƒ‡ã‚¸ã‚¿ãƒ«ã‚µã‚¤ãƒãƒ¼ã‚¸ã‚·ã‚¹ãƒ†ãƒ ã€‚äºˆå®šã€é€£çµ¡äº‹é …ã€æå‡ºç‰©ã€åºƒå‘Šã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§è¡¨ç¤ºãƒ»ç®¡ç†ã§ãã¾ã™ã€‚

## ğŸ¯ æ¦‚è¦

ã“ã®ã‚·ã‚¹ãƒ†ãƒ ã¯ã€æ•™å®¤ã«è¨­ç½®ã•ã‚ŒãŸãƒ‡ã‚£ã‚¹ãƒ—ãƒ¬ã‚¤ã«å­¦æ ¡æƒ…å ±ã‚’è¡¨ç¤ºã™ã‚‹ãŸã‚ã®Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã™ã€‚Firebase ã‚’ä½¿ç”¨ã—ãŸãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ åŒæœŸã«ã‚ˆã‚Šã€ç®¡ç†è€…ãŒæ›´æ–°ã—ãŸæƒ…å ±ã¯å³åº§ã«ã‚µã‚¤ãƒãƒ¼ã‚¸ç”»é¢ã«åæ˜ ã•ã‚Œã¾ã™ã€‚

### ä¸»ãªæ©Ÿèƒ½

- ğŸ“… **ä»Šå¾Œ3æ—¥é–“ã®äºˆå®šè¡¨ç¤º**ï¼ˆåœŸæ—¥ã‚’è‡ªå‹•ã‚¹ã‚­ãƒƒãƒ—ï¼‰
- ğŸ“¢ **å„ç¨®é€£çµ¡äº‹é …**ï¼ˆé‡è¦ãƒãƒ¼ã‚¯å¯¾å¿œï¼‰
- âš ï¸ **æå‡ºç‰©ç®¡ç†**ï¼ˆæœŸé™åˆ‡ã‚Œè­¦å‘Šã€æ®‹ã‚Šæ—¥æ•°è¡¨ç¤ºï¼‰
- ğŸ–¼ï¸ **åºƒå‘Šãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³**ï¼ˆæœ€å¤§5æšã€è¡¨ç¤ºæ™‚é–“è¨­å®šå¯èƒ½ï¼‰
- ğŸ”” **æ›´æ–°é€šçŸ¥**ï¼ˆéŸ³å£°é€šçŸ¥ + è¦–è¦šçš„ãƒãƒŠãƒ¼ï¼‰
- ğŸ”‡ **æˆæ¥­æ™‚é–“ãƒ¢ãƒ¼ãƒ‰**ï¼ˆQuiet Hours: éŸ³å£°ãƒ»åºƒå‘Šã®è‡ªå‹•ç„¡åŠ¹åŒ–ï¼‰
- ğŸ“± **è‡ªå‹•ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«**ï¼ˆã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŒå¤šã„å ´åˆã«è‡ªå‹•ã§ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ï¼‰
- ğŸ–¥ï¸ **ã‚­ã‚ªã‚¹ã‚¯ãƒ¢ãƒ¼ãƒ‰å¯¾å¿œ**ï¼ˆè‡ªå‹•èµ·å‹•ç”¨ï¼‰

## ğŸ—ï¸ ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆ

```
signage/
â”œâ”€â”€ public/                    # ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼ˆFirebase Hostingï¼‰
â”‚   â”œâ”€â”€ index.html            # ã‚µã‚¤ãƒãƒ¼ã‚¸è¡¨ç¤ºç”»é¢
â”‚   â”œâ”€â”€ dashboard.html        # ç®¡ç†è€…ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰
â”‚   â”œâ”€â”€ admin.html            # ç®¡ç†è€…è¨­å®šï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†ç­‰ï¼‰
â”‚   â”œâ”€â”€ main.js               # ã‚µã‚¤ãƒãƒ¼ã‚¸è¡¨ç¤ºãƒ­ã‚¸ãƒƒã‚¯
â”‚   â”œâ”€â”€ dashboard.js          # ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ãƒ­ã‚¸ãƒƒã‚¯
â”‚   â”œâ”€â”€ config.js             # Firebaseè¨­å®š & èªè¨¼ãƒ˜ãƒ«ãƒ‘ãƒ¼
â”‚   â”œâ”€â”€ auth.js               # èªè¨¼UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”œâ”€â”€ ui.js                 # UIæç”»ãƒ˜ãƒ«ãƒ‘ãƒ¼
â”‚   â”œâ”€â”€ utils.js              # å…±é€šãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
â”‚   â””â”€â”€ *.css                 # ã‚¹ã‚¿ã‚¤ãƒ«ã‚·ãƒ¼ãƒˆ
â”œâ”€â”€ functions/                 # Firebase Cloud Functions
â”‚   â””â”€â”€ index.js              # ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†API
â”œâ”€â”€ firebase.json              # Firebaseè¨­å®š
â”œâ”€â”€ firestore.rules           # Firestoreã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ«ãƒ¼ãƒ«
â”œâ”€â”€ storage.rules             # Storageã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ«ãƒ¼ãƒ«
â””â”€â”€ setup-admin.js            # åˆæœŸç®¡ç†è€…ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
```

## ğŸ”§ æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

| åŒºåˆ† | æŠ€è¡“ |
|------|------|
| ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ | Vanilla JavaScript (ES Modules) |
| ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ | Firebase Cloud Functions (Node.js 20) |
| ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ | Cloud Firestore |
| ãƒ•ã‚¡ã‚¤ãƒ«ä¿å­˜ | Cloud Storage |
| èªè¨¼ | Firebase Authentication |
| ãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚° | Firebase Hosting |

## ğŸ“¦ ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

### å‰ææ¡ä»¶

- Node.js 20ä»¥ä¸Š
- Firebase CLI (`npm install -g firebase-tools`)
- Firebaseãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ

### 1. ãƒªãƒã‚¸ãƒˆãƒªã®ã‚¯ãƒ­ãƒ¼ãƒ³

```bash
git clone <repository-url>
cd signage
```

### 2. ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
npm install
cd functions && npm install && cd ..
```

### 3. Firebaseè¨­å®š

```bash
# Firebaseã«ãƒ­ã‚°ã‚¤ãƒ³
firebase login

# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’é¸æŠ/ä½œæˆ
firebase use --add
```

### 4. Firebaseè¨­å®šã®æ›´æ–°

`public/config.js` ã¨ `public/main.js` ã® `firebaseConfig` ã‚’è‡ªåˆ†ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®è¨­å®šã«æ›´æ–°ã—ã¦ãã ã•ã„ï¼š

```javascript
const firebaseConfig = {
    apiKey: "YOUR_API_KEY",
    authDomain: "YOUR_PROJECT.firebaseapp.com",
    projectId: "YOUR_PROJECT",
    storageBucket: "YOUR_PROJECT.appspot.com",
    messagingSenderId: "YOUR_SENDER_ID",
    appId: "YOUR_APP_ID"
};
```

### 5. åˆæœŸç®¡ç†è€…ã®ä½œæˆ

`serviceAccountKey.json` ã‚’ Firebase Console ã‹ã‚‰ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆã«é…ç½®ã€‚

```bash
# setup-admin.js ã‚’ç·¨é›†ã—ã¦ç®¡ç†è€…æƒ…å ±ã‚’è¨­å®šå¾Œ
node setup-admin.js
```

### 6. ãƒ‡ãƒ—ãƒ­ã‚¤

```bash
# ã™ã¹ã¦ã‚’ãƒ‡ãƒ—ãƒ­ã‚¤
firebase deploy

# å€‹åˆ¥ã«ãƒ‡ãƒ—ãƒ­ã‚¤
firebase deploy --only hosting
firebase deploy --only functions
firebase deploy --only firestore:rules
firebase deploy --only storage:rules
```

## ğŸ“± ä½¿ã„æ–¹

### ã‚µã‚¤ãƒãƒ¼ã‚¸ç”»é¢ï¼ˆè¡¨ç¤ºç”¨ï¼‰

- **URL**: `https://YOUR_PROJECT.web.app/`
- èªè¨¼ä¸è¦ã§é–²è¦§å¯èƒ½
- èµ·å‹•æ™‚ã«5ç§’ã®ã‚«ã‚¦ãƒ³ãƒˆãƒ€ã‚¦ãƒ³ï¼ˆã‚¿ãƒƒãƒ—ã§ã‚¹ã‚­ãƒƒãƒ—å¯èƒ½ï¼‰
- ã‚­ã‚ªã‚¹ã‚¯ãƒ¢ãƒ¼ãƒ‰: `?kiosk=1` ã¾ãŸã¯ `?autostart=1` ã‚’ä»˜ä¸

### ç®¡ç†è€…ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰

- **URL**: `https://YOUR_PROJECT.web.app/dashboard.html`
- ç®¡ç†è€…èªè¨¼å¿…é ˆï¼ˆãƒ¡ãƒ¼ãƒ«/ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ ã¾ãŸã¯ Googleï¼‰
- å„é …ç›®ã‚’ã‚¯ãƒªãƒƒã‚¯ã§ç·¨é›†ã€ã€Œ+ è¿½åŠ ã€ã§æ–°è¦ä½œæˆ

### ç®¡ç†ã§ãã‚‹é …ç›®

| é …ç›® | èª¬æ˜ |
|------|------|
| ã‚¯ãƒ©ã‚¹å | ç”»é¢å³ä¸Šã«è¡¨ç¤ºã•ã‚Œã‚‹åå‰ |
| äºˆå®š | æ—¥æ™‚ã¨å†…å®¹ã€è¡¨ç¤ºæœŸé–“ã‚’è¨­å®šå¯èƒ½ |
| é€£çµ¡äº‹é … | ãƒ†ã‚­ã‚¹ãƒˆã¨é‡è¦ãƒ•ãƒ©ã‚° |
| æå‡ºç‰© | æœŸé™ã€ç§‘ç›®ã€æå‡ºç‰©å |
| åºƒå‘Šç”»åƒ | æœ€å¤§5æšã€ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³è¡¨ç¤º |

## ğŸ—„ï¸ ãƒ‡ãƒ¼ã‚¿æ§‹é€ 

### Firestore

```
schools/
â””â”€â”€ {SCHOOL_ID}/
    â”œâ”€â”€ config/
    â”‚   â””â”€â”€ display_settings    # ã‚¯ãƒ©ã‚¹åã€åºƒå‘Šã€æˆæ¥­æ™‚é–“è¨­å®š
    â””â”€â”€ daily_data/
        â””â”€â”€ {YYYY-MM-DD}/       # æ—¥ä»˜ã”ã¨ã®ãƒ‡ãƒ¼ã‚¿
            â”œâ”€â”€ schedules[]     # äºˆå®šãƒªã‚¹ãƒˆ
            â”œâ”€â”€ notices[]       # é€£çµ¡ãƒªã‚¹ãƒˆ
            â””â”€â”€ assignments[]   # æå‡ºç‰©ãƒªã‚¹ãƒˆ
```

### display_settings ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

```javascript
{
  class_name: "1å¹´Açµ„",
  ads: [
    { id: "ad_xxx", type: "image", url: "...", duration_sec: 10 }
  ],
  quiet_hours: [
    { start: "08:50", end: "09:40" },  // 1é™
    { start: "09:50", end: "10:40" }   // 2é™
    // ...
  ]
}
```

### daily_data ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

```javascript
{
  date: "2025-01-20",
  schedules: [
    { time: "1é™", content: "æ•°å­¦ãƒ†ã‚¹ãƒˆ", display_start: "", display_end: "" }
  ],
  notices: [
    { text: "æ˜æ—¥ã¯ä½“è‚²ç¥­ã§ã™", is_highlight: true }
  ],
  assignments: [
    { deadline: "2025-01-25", subject: "å›½èª", task: "èª­æ›¸æ„Ÿæƒ³æ–‡" }
  ]
}
```

## ğŸ”’ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£

### èªè¨¼ãƒ»æ¨©é™

- **ã‚µã‚¤ãƒãƒ¼ã‚¸ç”»é¢**: èªè¨¼ä¸è¦ï¼ˆå…¬é–‹ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ï¼‰
- **ç®¡ç†ç”»é¢**: ç®¡ç†è€…æ¨©é™ï¼ˆCustom Claims: `admin: true`ï¼‰ãŒå¿…é ˆ
- **Cloud Functions**: ç®¡ç†è€…ã®ã¿å®Ÿè¡Œå¯èƒ½

### Firestoreãƒ«ãƒ¼ãƒ«æ¦‚è¦

| ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ | èª­ã¿å–ã‚Š | æ›¸ãè¾¼ã¿ |
|--------------|----------|----------|
| schools/{id}/config/* | å…¨å“¡ | èªè¨¼æ¸ˆã¿ç®¡ç†è€… |
| schools/{id}/daily_data/* | å…¨å“¡ | èªè¨¼æ¸ˆã¿ç®¡ç†è€… |
| settings/* | ç®¡ç†è€… | ç®¡ç†è€… |
| users/* | æœ¬äºº or ç®¡ç†è€… | ç®¡ç†è€… |

### Storageãƒ«ãƒ¼ãƒ«æ¦‚è¦

- `/images/**`, `/videos/**`, `/media/**`: èª­ã¿å–ã‚Šå…¬é–‹ã€ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã¯ç®¡ç†è€…ã®ã¿
- ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºåˆ¶é™: ç”»åƒ50MBã€å‹•ç”»100MB
- `/private/**`: ç®¡ç†è€…ã®ã¿ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½

## ğŸ› ï¸ Cloud Functions

| é–¢æ•°å | èª¬æ˜ |
|--------|------|
| `listUsers` | ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§å–å¾— |
| `createAdminUser` | ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½œæˆ |
| `setAdminRole` | ç®¡ç†è€…æ¨©é™ã®ä»˜ä¸/å‰Šé™¤ |
| `updateUser` | ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±æ›´æ–° |
| `deleteUser` | ãƒ¦ãƒ¼ã‚¶ãƒ¼å‰Šé™¤ |
| `toggleUserStatus` | ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æœ‰åŠ¹/ç„¡åŠ¹åˆ‡æ›¿ |
| `setEmailVerified` | ãƒ¡ãƒ¼ãƒ«æ¤œè¨¼ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æ›´æ–° |

## ğŸ–¥ï¸ ã‚­ã‚ªã‚¹ã‚¯ãƒ¢ãƒ¼ãƒ‰è¨­å®šï¼ˆRaspberry Piç­‰ï¼‰

### Chromiumã§ã®è‡ªå‹•èµ·å‹•ä¾‹

```bash
# /home/pi/.config/lxsession/LXDE-pi/autostart
@chromium-browser --kiosk --disable-infobars https://YOUR_PROJECT.web.app/?kiosk=1
```

### æ¨å¥¨è¨­å®š

- ç”»é¢è§£åƒåº¦: 1920Ã—1080ï¼ˆãƒ•ãƒ«HDï¼‰ä»¥ä¸Š
- ãƒ–ãƒ©ã‚¦ã‚¶: Chromium / Chrome
- è‡ªå‹•æ›´æ–°: ãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢ + ãƒªãƒ­ãƒ¼ãƒ‰ã‚’å®šæœŸå®Ÿè¡Œ

## ğŸ”Š éŸ³å£°é€šçŸ¥ã«ã¤ã„ã¦

- **ãƒ–ãƒ©ã‚¦ã‚¶åˆ¶ç´„**: åˆå›ãƒ¦ãƒ¼ã‚¶ãƒ¼æ“ä½œå‰ã¯éŸ³å£°å†ç”ŸãŒãƒ–ãƒ­ãƒƒã‚¯ã•ã‚Œã‚‹å ´åˆãŒã‚ã‚Šã¾ã™
- **èµ·å‹•ç”»é¢**: ã‚¿ãƒƒãƒ—ã™ã‚‹ã“ã¨ã§AudioContextãŒæœ‰åŠ¹åŒ–ã•ã‚Œã¾ã™
- **ã‚­ã‚ªã‚¹ã‚¯ãƒ¢ãƒ¼ãƒ‰**: è‡ªå‹•èµ·å‹•ã®å ´åˆã€éŸ³å£°ãŒç„¡åŠ¹ã«ãªã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™
- **ç”»é¢å³ä¸‹**: ğŸ”Š/ğŸ”‡ ã‚¢ã‚¤ã‚³ãƒ³ã§éŸ³å£°çŠ¶æ…‹ã‚’ç¢ºèªå¯èƒ½

## âš™ï¸ ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º

### å­¦æ ¡IDã®å¤‰æ›´

`public/config.js` ã® `SCHOOL_ID` ã‚’å¤‰æ›´ï¼š

```javascript
export const SCHOOL_ID = "your_school_id";
```

### ã‚¹ã‚¿ã‚¤ãƒ«ã®å¤‰æ›´

- `public/style.css`: ã‚µã‚¤ãƒãƒ¼ã‚¸ç”»é¢ã®ã‚¹ã‚¿ã‚¤ãƒ«
- `public/dashboard-style.css`: ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã®ã‚¹ã‚¿ã‚¤ãƒ«
- `public/auth-style.css`: ãƒ­ã‚°ã‚¤ãƒ³ç”»é¢ã®ã‚¹ã‚¿ã‚¤ãƒ«

### æˆæ¥­æ™‚é–“ï¼ˆQuiet Hoursï¼‰ã®è¨­å®š

ç®¡ç†ç”»é¢ã‹ã‚‰ã€ã¾ãŸã¯ Firestore ã§ç›´æ¥ `display_settings.quiet_hours` ã‚’ç·¨é›†ï¼š

```javascript
quiet_hours: [
  { start: "08:50", end: "09:40" },  // 1é™
  { start: "09:50", end: "10:40" },  // 2é™
  // å¿…è¦ã«å¿œã˜ã¦è¿½åŠ 
]
```

## ğŸ› ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ãƒ­ã‚°ã‚¤ãƒ³ã§ããªã„

1. Firebase Authentication ã§ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒä½œæˆã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
2. Custom Claims ã« `admin: true` ãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
3. ãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§ã‚¨ãƒ©ãƒ¼ã‚’ç¢ºèª

### ãƒ‡ãƒ¼ã‚¿ãŒè¡¨ç¤ºã•ã‚Œãªã„

1. Firestore ã«ãƒ‡ãƒ¼ã‚¿ãŒå­˜åœ¨ã™ã‚‹ã‹ç¢ºèª
2. `SCHOOL_ID` ãŒæ­£ã—ã„ã‹ç¢ºèª
3. ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ«ãƒ¼ãƒ«ãŒãƒ‡ãƒ—ãƒ­ã‚¤ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª

### ç”»åƒãŒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã§ããªã„

1. Storage ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ«ãƒ¼ãƒ«ã‚’ç¢ºèª
2. ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºãŒ50MBä»¥ä¸‹ã‹ç¢ºèª
3. ãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼ãŒç”»åƒï¼ˆimage/*ï¼‰ã‹ç¢ºèª

## ğŸ“„ ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

Proprietary - All rights reserved.

## ğŸ‘¥ é–‹ç™º

Rebounder Team

---

**Edix by Rebounder** - æ•™å®¤ã‚’ã‚¹ãƒãƒ¼ãƒˆã«ã€‚